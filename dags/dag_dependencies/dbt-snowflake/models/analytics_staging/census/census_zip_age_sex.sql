{{
    config(
        tags=['daily'],
        materialized='view'
    )
}}

SELECT
    c1 AS geo_id,
    SPLIT_PART(c2, ' ', 2) AS zcta,
    c3 AS total_population,
    c5 AS total_population_under_5_years,
    c7 AS total_population_5_to_9_years,
    c9 AS total_population_10_to_14_years,
    c11 AS total_population_15_to_19_years,
    c13 AS total_population_20_to_24_years,
    c15 AS total_population_25_to_29_years,
    c17 AS total_population_30_to_34_years,
    c19 AS total_population_35_to_39_years,
    c21 AS total_population_40_to_44_years,
    c23 AS total_population_45_to_49_years,
    c25 AS total_population_50_to_54_years,
    c27 AS total_population_55_to_59_years,
    c29 AS total_population_60_to_64_years,
    c31 AS total_population_65_to_69_years,
    c33 AS total_population_70_to_74_years,
    c35 AS total_population_75_to_79_years,
    c37 AS total_population_80_to_84_years,
    c39 AS total_population_85_years_and_over,
    c155 AS total_male_population,
    c157 AS total_male_under_5_years,
    c159 AS total_male_5_to_9_years,
    c161 AS total_male_10_to_14_years,
    c163 AS total_male_15_to_19_years,
    c165 AS total_male_20_to_24_years,
    c167 AS total_male_25_to_29_years,
    c169 AS total_male_30_to_34_years,
    c171 AS total_male_35_to_39_years,
    c173 AS total_male_40_to_44_years,
    c175 AS total_male_45_to_49_years,
    c177 AS total_male_50_to_54_years,
    c179 AS total_male_55_to_59_years,
    c181 AS total_male_60_to_64_years,
    c183 AS total_male_65_to_69_years,
    c185 AS total_male_70_to_74_years,
    c187 AS total_male_75_to_79_years,
    c189 AS total_male_80_to_84_years,
    c191 AS total_male_85_years_and_over,
    c307 AS total_female_population,
    c309 AS total_female_under_5_years,
    c311 AS total_female_5_to_9_years,
    c313 AS total_female_10_to_14_years,
    c315 AS total_female_15_to_19_years,
    c317 AS total_female_20_to_24_years,
    c319 AS total_female_25_to_29_years,
    c321 AS total_female_30_to_34_years,
    c323 AS total_female_35_to_39_years,
    c325 AS total_female_40_to_44_years,
    c327 AS total_female_45_to_49_years,
    c329 AS total_female_50_to_54_years,
    c331 AS total_female_55_to_59_years,
    c333 AS total_female_60_to_64_years,
    c335 AS total_female_65_to_69_years,
    c337 AS total_female_70_to_74_years,
    c339 AS total_female_75_to_79_years,
    c341 AS total_female_80_to_84_years,
    c343 AS total_female_85_years_and_over
FROM {{ source('census', 'census_age_sex_acsst5y2022_s0101') }}
WHERE geo_id NOT ILIKE '%GEO%'
